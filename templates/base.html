{% load static %}
<!DOCTYPE html>
<html lang="id">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Admin Pelaporan Hoax Polda Sumbar">
    <meta name="author" content="Polda Sumbar">

    <title>PLN UIP Sulawesi</title>

    <!-- Custom fonts for this template-->
    <link href="{% static 'css/all.min.css' %}" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Material Icon -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="{% static 'css/sb-admin-2.css' %}" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/searchbuilder/1.3.4/css/searchBuilder.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/searchpanes/2.0.2/css/searchPanes.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedheader/3.2.4/css/fixedHeader.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/fixedheader/3.2.4/css/fixedHeader.bootstrap5.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.3.0/css/responsive.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/scroller/2.0.7/css/scroller.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/keytable/2.7.0/css/keyTable.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css">

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans&display=swap" rel="stylesheet">

    <style>
        @media (min-width: 768px){
            .sidebar .nav-item .nav-link span {
                font-size: 0.9rem;
            }
        }
        
        td, th {
            vertical-align: middle !important;
        }

        th {
            /* border: 1px solid #161616 !important; */
            text-align: center !important; 
        }
        
        thead {
            background-color: #0FA3B1;
            color: #fff;
        }

        .card-header{
            background-color: #161616;
        }

        .card-header > h6{
            color: #fff;
        }

        .header-info{
            color: #0FA3B1;
        }

        .nav-pills .nav-link.active{
            color: #FCFCFC;
            background-color: #161616;
        }

        
    </style>

    {% block style %}
    {% endblock style%}
</head>

<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        {% include 'snippets/sidebar_copy.html' %}
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Header -->
                {% include 'snippets/header.html' %}
                <!-- End of Header -->

                <!-- Begin Page Content -->
                {% block content %}
                {% endblock content%}
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            {% include 'snippets/footer.html' %}
            <!-- End of Footer -->
        </div>
    </div>

    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">Ã—</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="{% url 'logout' %}">Logout</a>
                </div>
            </div>
        </div>
    </div>

    {% include 'snippets/general_notifications.html' %}

    <!-- Bootstrap core JavaScript-->
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

    <!-- HTMX CDN -->
    <script src="https://unpkg.com/htmx.org@1.1.0"></script>
    <!-- handling CSRF request -->
    <script>
    document.body.addEventListener('htmx:configRequest', (event) => {
        event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
    })
    </script>

    <!-- Datatables required-->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/searchbuilder/1.3.4/js/dataTables.searchBuilder.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/searchpanes/2.0.2/js/dataTables.searchPanes.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/fixedheader/3.2.4/js/dataTables.fixedHeader.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/scroller/2.0.7/js/dataTables.scroller.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/keytable/2.7.0/js/dataTables.keyTable.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
    
    <script src="{% static 'js/sb-admin-2.min.js' %}"></script>
    <script src="{% static 'js/ddtf.js' %}"></script>

    <!-- Pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.min.js" integrity="sha512-Z8CqofpIcnJN80feS2uccz+pXWgZzeKxDsDNMD/dJ6997/LSRY+W4NmEt9acwR+Gt9OHN0kkI1CTianCwoqcjQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!--<script src="{% static 'js/jquery-3.6.0.js' %}"></script>-->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

    <script>
        // Call the dataTables jQuery plugin
    
        $(document).ready(function() {
            $('#dataTable').DataTable({
                "paging": true,
                fixedHeader: true,
            });
        });
    </script>
    
    <!-- WebSocket Open -->
    <script>
        //var wsStart='wss://'
        var wsStart = window.location.protocol == "https:" ? "wss://" : "ws://";
        //var endpoint = wsStart + window.location.host + window.location.pathname
        var endpoint = wsStart + window.location.host + "/";
        var notificationSocket = new WebSocket(endpoint)
    
        notificationSocket.onclose = function(e) {
            console.error('Notification Socket closed unexpectedly');
        };
    
        notificationSocket.onopen = function(e){
            console.log("Notification Socket on open: " + e)
            
            setupGeneralNotificationsMenu()
            getFirstGeneralNotificationsPage()
            getUnreadGeneralNotificationsCount()
    
            //setupChatNotificationsMenu()
            //getFirstChatNotificationsPage()
        }
    
        notificationSocket.onmessage = function(message){
            console.log(message)
            var data = JSON.parse(message.data);
            console.log("Got notification websocket message. " + data.general_msg_type);
            
            /*
                GENERAL NOTIFICATIONS
            */
            // new 'general' notifications data payload
            if(data.general_msg_type == 0){
                handleGeneralNotificationsData(JSON.parse(data['notifications']), data['new_page_number'])
            }
    
            // "General" Pagination exhausted. No more results.
            if(data.general_msg_type == 1){
                setGeneralPaginationExhausted()
            }
    
            // Refresh [newest_timestamp >= NOTIFICATIONS >= oldest_timestamp]
            if(data.general_msg_type == 2){
                refreshGeneralNotificationsData(JSON.parse(data['notifications']))
            }
    
            if(data.general_msg_type == 3){
                handleNewGeneralNotificationsData(JSON.parse(data['notifications']))
            }
    
            if(data.general_msg_type == 4){
                setUnreadGeneralNotificationsCount(data['count'])
            }
    
            if(data.general_msg_type == 5){
                updateGeneralNotificationDiv(data['notification'])
            }
    
            
        }
    
    </script>

    {% block script %}
    {% endblock script%}

</body>

</html>